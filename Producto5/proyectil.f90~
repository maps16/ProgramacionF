!=======================================================================================
!  Este programa te permitira graficar el movimeinto de un proyectil en un sistema ideal
!                        Calcula "x" y "y" en intervalos de tiempo de 0.01 segundos
!=======================================================================================

subroutine posicion(v, radian, j, m, n)
  
  implicit none
  real, parameter:: g = 9.81
  real:: m , n
  real:: v, radian, ti
  integer:: j

  ti= (float(j)*0.01)
  m = v*cos(radian)*ti
  n = v*sin(radian)*ti-0.5g*ti*ti

end subroutine posicion

program proyectil
  implicit none
  !Declaraci√≥n de constantes
  real , parameter :: pi=4.0*atan(1.0)
  real :: iv , rad , t , a, x, y
  real :: S(300), R(300)
  integer :: i
  !pi es pi y g es la gravedad
  !iv  Velocidad inicial
  !rad Angulo en radianes y "a" es el Angulo en grados
  !t Tiempo
  !"x" y "y" Donde se organizara la informacion de salida
  
  !Ingreso de datos por usuario
  write(*,*) 'Ingrese el angulo de lanzamiento en grados (Valores Reales)'
  read *, a
  write(*,*) 'Ingrese la velocidad inicial (Valores Reales)'
  read *, iv
  !transformar angulo a radianes
  rad = (a*pi)/180.0

  !Abrir archivo de salida de datos
  open (1,file='proyectil.dat')
 
 do i=1,300
  
     call posicion (iv, rad, i, x, y)
    S(i)= x
    R(i)= y
     !escribir en proyectil.dat
     write(1,*) S(i), R(i)
     !Forzar salida para casos especiales cuando y es menor que 0
     if (R(i)<0) exit

  end do

  close(1)
  !Se cerro el archivo
end program proyectil
