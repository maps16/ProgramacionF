Module Conteo

  Implicit None
  Integer, Parameter :: Dat=7632 !Numeros de datos Totales
  Integer, Parameter :: Mes=1440 !Datos en un Mes
  Integer, Parameter :: Dias=159 !Numero de dias
  Integer, Parameter :: Day= 48  !Datos en un Dia
  Integer, Parameter :: Mdia=24  !Datos en medio dia
  Integer, Parameter :: MCo=5760 !Datos de los meses Completos

End Module Conteo

Program Periodos
  
  Use Conteo
  Implicit None
  Real,Dimension(Dat) :: T, Alt, Doy, Dyt, PeM, PeD
  Real:: Maxm, Tmaxm, Maxd, Tmaxd
  Real,Dimension(1:5):: Ti,Al
  Real, Dimension(Dias):: Tie, A
  Integer:: i, j


  Open(2, File="Mareas.csv")
  Open(3, File="Marea.dat", Status="Replace")
  Do i=1, Dat, 1
     Read(2,*) T(i), Alt(i), Doy(i), Dyt(i)
     Write(3,2) Dyt(i), Alt(i)
  End Do
  Close(2)
  Close(3)
  
  !Claculo de Maximos por mes  
  Open(4, File="MaxMes.dat", Status="Replace")
  Do j=0, MCo, Mes
     Maxm=-1
     Do i=1, Mes, 1
        If(Alt(i+j)>Maxm) Then
           Maxm=Alt(i+j)
           Tmaxm=Dyt(i+j)
        End If
     End Do
     Write(4,2) Tmaxm, Maxm
  End Do
  Close(4)
!Calculo de Maximos por dia  
  Open (5, File="MaxDias.dat")
  Do j=0,Dat-1 , Day
     Maxd=-1
     Do i=1, Day, 1
        If(Alt(i+j)>Maxd) Then
           Maxd=Alt(i+j)
           Tmaxd=Dyt(i+j)
        End If
     End Do
     Write(5,2) Tmaxd, Maxd
  End Do
  Close(5)

!Calculo de periodos

  Open(6, File="MaxMes.dat")
  Open(7, File="MaxDias.dat")

 ! Do i=1,5, 1 
 !    Read(6,*) Ti(i), Al(i)
 !    Write(*,*) Ti(i), Al(i)
 ! End Do

  Do i=1 , Dias, 1
     Read(7,*) Tie(i), A(i) 
     Write(*,2) Tie(i), A(i)
  End Do
Close (6)
Close (7)

  
  2 Format(2F10.2)
End Program Periodos
